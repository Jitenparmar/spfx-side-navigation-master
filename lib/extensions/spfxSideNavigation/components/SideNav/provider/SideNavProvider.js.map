{"version":3,"sources":["extensions/spfxSideNavigation/components/SideNav/provider/SideNavProvider.ts"],"names":[],"mappings":"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","file":"extensions/spfxSideNavigation/components/SideNav/provider/SideNavProvider.js","sourcesContent":["import ISideNavProvider from \"./ISideNavProvider\";\nimport ISideNavItem from \"../model/ISideNavItem\";\nimport ISPSideNavItem from \"../model/ISPSideNavItem\";\nimport { sp, SPRest, Web } from \"@pnp/sp\";\n\n\nexport default class SideNavProvider implements ISideNavProvider {\n  public getSideNav(): Promise<ISideNavItem[]> {\n    return sp.web.lists.getByTitle(\"Shortcuts\").items.select(\"ID\", \"Title\", \"LinkType\", \"Link\")\n      .orderBy(\"Title\").usingCaching().get()\n      .then(\n        (items: ISPSideNavItem[]): ISideNavItem[] => {\n\n          const siteNavItems: ISideNavItem[] = [];\n\n          if (this.existsItemsInShortcuts(items, 'Page')) {\n            siteNavItems.push({ ///SitePages\n              title: 'Pages',\n              svg: '<?xml version=\"1.0\" encoding=\"iso-8859-1\"?><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\t viewBox=\"0 0 50 50\" style=\"enable-background:new 0 0 50 50;\" xml:space=\"preserve\"><g id=\"Layer_1\"><path d=\"M44,8.586L36.414,1H6v48h38V8.586z M37,4.414L40.586,8H37V4.414z M8,47V3h27v7h7v37H8z\"/></g><g></g></svg>', url: '', openInNewWindow: false,\n              subNavItems: this.getSubNavItemsByShortcuts(items, 'Page')\n            });\n          }\n\n          if (this.existsItemsInShortcuts(items, 'Hyperlink')) {\n            siteNavItems.push({\n              title: 'Hyperlinks',\n              svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-external-link\"><path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"></path><polyline points=\"15 3 21 3 21 9\"></polyline><line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"></line></svg>',\n              url: '', openInNewWindow: false,\n              subNavItems: this.getSubNavItemsByShortcuts(items, 'Hyperlink')\n            });\n          }\n\n          if (this.existsItemsInShortcuts(items, 'Library')) {\n            siteNavItems.push({ ///_layouts/15/viewlsts.aspx\n              title: 'Libraries',\n              svg: '<svg xmlns=\"http://www.w3.org/2000/svg\"   viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-folder\"><path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\"></path></svg>',\n              url: '', openInNewWindow: false,\n              subNavItems: this.getSubNavItemsByShortcuts(items, 'Library')\n            });\n          }\n\n          if (this.existsItemsInShortcuts(items, 'List')) {\n            siteNavItems.push({\n              title: 'Lists',\n              svg: '<svg xmlns=\"http://www.w3.org/2000/svg\"   viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-list\"><line x1=\"8\" y1=\"6\" x2=\"21\" y2=\"6\"></line><line x1=\"8\" y1=\"12\" x2=\"21\" y2=\"12\"></line><line x1=\"8\" y1=\"18\" x2=\"21\" y2=\"18\"></line><line x1=\"3\" y1=\"6\" x2=\"3\" y2=\"6\"></line><line x1=\"3\" y1=\"12\" x2=\"3\" y2=\"12\"></line><line x1=\"3\" y1=\"18\" x2=\"3\" y2=\"18\"></line></svg>',\n              url: '', openInNewWindow: false,\n              subNavItems: this.getSubNavItemsByShortcuts(items, 'List')\n            });\n          }\n          /**\n           * Commented By Jiten Parmar \n           \n          if (this.existsSubWebs(sp.web)) {\n            \n            siteNavItems.push({\n              title: 'Sub Sites', \n              svg: '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 1000 1000\" enable-background=\"new 0 0 1000 1000\" xml:space=\"preserve\"><metadata> Svg Vector Icons : http://www.onlinewebfonts.com/icon </metadata><g><g transform=\"translate(0.000000,511.000000) scale(0.100000,-0.100000)\"><path d=\"M2545.2,2020.3L100-424.9h534.9h534.9l1914.2,1914.2L5000,3405.3l1916.1-1916.1L8830.2-424.9h534.9H9900L7454.8,2020.3C6109.9,3365.2,5005.7,4465.6,5000,4465.6S3890.1,3365.2,2545.2,2020.3z\"/><path d=\"M3294.1,1279.1L1599.6-415.3v-1916.1v-1914.2h1700.2H5000v1490.1v1490.1h850.1h850.1v-1490.1v-1490.1h850.1h850.1v1916.1v1914.2L6704,1281c-932.2,932.2-1698.3,1694.5-1704,1694.5S4228.2,2213.3,3294.1,1279.1z\"/></g></g></svg>', \n              url: '', openInNewWindow: false, \n              subNavItems: this.getSubSites(sp.web) });\n          }\n          */\n          return siteNavItems;\n        }\n      );\n  }\n  public getSubSitesNav(): Promise<ISideNavItem[]> {\n    return sp.web.webs.select(\"Title\", \"Url\").get().then(\n      async (items: ISPSideNavItem[]): Promise<ISideNavItem[]> => {\n        const subNavItems: ISideNavItem[] = [];\n        items.map((item: {Title:any,Url:any},index:any) =>{\n          subNavItems.push({ title: item.Title, url: item.Url, openInNewWindow: false })\n        });\n        if (items.length > 0) {\n          const siteNavItems: ISideNavItem[] = [];\n          siteNavItems.push({\n            title: 'Sub Sites',\n            svg: '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 1000 1000\" enable-background=\"new 0 0 1000 1000\" xml:space=\"preserve\"><metadata> Svg Vector Icons : http://www.onlinewebfonts.com/icon </metadata><g><g transform=\"translate(0.000000,511.000000) scale(0.100000,-0.100000)\"><path d=\"M2545.2,2020.3L100-424.9h534.9h534.9l1914.2,1914.2L5000,3405.3l1916.1-1916.1L8830.2-424.9h534.9H9900L7454.8,2020.3C6109.9,3365.2,5005.7,4465.6,5000,4465.6S3890.1,3365.2,2545.2,2020.3z\"/><path d=\"M3294.1,1279.1L1599.6-415.3v-1916.1v-1914.2h1700.2H5000v1490.1v1490.1h850.1h850.1v-1490.1v-1490.1h850.1h850.1v1916.1v1914.2L6704,1281c-932.2,932.2-1698.3,1694.5-1704,1694.5S4228.2,2213.3,3294.1,1279.1z\"/></g></g></svg>',\n            url: '', openInNewWindow: false,\n            subNavItems: subNavItems\n          });\n          return siteNavItems;\n        }\n      }\n    )\n  };\n\n  /*public getSubSitesNav(): Promise<ISideNavItem[]>{\n    var b = sp.createBatch();\n    const subNavItems: ISideNavItem[] = [];\n\n    var checkWeb = function(webUrl) {\n      let web = new Web(webUrl);\n      web.select(\"Title, Url, Webs\").expand(\"Webs\").inBatch(b).get().then(w => {\n        console.log(\"Site\", w.Title)\n        // Check if any subsite\n        if(w.Webs.length > 0) {\n          w.Webs.forEach(function(subsite) {\n            // Add subsites to array\n            subNavItems.push({\n              title: subsite.Title,\n              url: subsite.Url, openInNewWindow: false\n            })\n            // Call recursive for current subsite\n            checkWeb(subsite.Url);\n          })\n        }\n      });\n    };\n\n    sp.web.inBatch(b).get().then(\n      async w => { \n      subNavItems.push({\n        title: w.Title,\n        url: w.Url, openInNewWindow: false\n      })\n      checkWeb(w.Url);\n     });\n\n     return subNavItems;\n\n  }\n  https://github.com/SharePoint/PnP-JS-Core/issues/578\n  */\n\n\n  private async getSubSites(web: Web): Promise<ISideNavItem[]> {\n\n    const subNavItems: ISideNavItem[] = [];\n\n    // subNavItems.push({ title: 'test', url: '', openInNewWindow: false });\n    web.webs.select(\"Title\", \"Url\").get().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        subNavItems.push({ title: data[i].Title, url: data[i].Url, openInNewWindow: false });\n      }\n\n    }).catch(function (data) {\n      subNavItems.push({ title: 'error', url: '', openInNewWindow: false });\n    });\n    return subNavItems.length > 0 ? subNavItems : undefined;\n  }\n\n  private existsSubWebs(web: Web): boolean {\n\n    let rtn: boolean = false;\n\n    web.webs.get().then(function (data) {\n      if (data.length > 0) {\n        rtn = true;\n        return;\n      }\n    }).catch(function (data) {\n    });\n\n    return rtn;\n  }\n\n  private existsItemsInShortcuts(spNavItems: ISPSideNavItem[], filter: string): boolean {\n\n    let rtn: boolean = false;\n\n    spNavItems.forEach(\n      (item: ISPSideNavItem): void => {\n        if (item.LinkType === filter) {\n          rtn = true;\n          return;\n        }\n      }\n    );\n\n    return rtn;\n  }\n\n  private getSubNavItemsByShortcuts(spNavItems: ISPSideNavItem[], filter: string): ISideNavItem[] {\n\n    const subNavItems: ISideNavItem[] = [];\n\n    spNavItems.forEach(\n      (item: ISPSideNavItem): void => {\n        if (item.LinkType === filter) {\n          subNavItems.push({ title: item.Title, url: item.Link, openInNewWindow: false });\n        }\n      }\n    );\n\n    return subNavItems.length > 0 ? subNavItems : undefined;\n  }\n\n  private getSubNavItems(\n    spNavItems: ISPSideNavItem[],\n    filter: string\n  ): ISideNavItem[] {\n    const subNavItems: ISideNavItem[] = [];\n    spNavItems.forEach(\n      (item: ISPSideNavItem): void => {\n        if (item.SideNavParent && item.SideNavParent.Title === filter) {\n          subNavItems.push({\n            title: item.Title,\n            url: item.SideNavUrl,\n            openInNewWindow: item.SideNavOpenInNewWindow\n          });\n        }\n      }\n    );\n    return subNavItems.length > 0 ? subNavItems : undefined;\n  }\n}\n"],"sourceRoot":"..\\..\\..\\..\\..\\..\\src"}